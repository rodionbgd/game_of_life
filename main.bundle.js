!function(){"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e){var t=e.elem,i=t.querySelector(".thumb"),r=0,n=t.getBoundingClientRect();function l(e){!function(e){var l=e-r-n.left;l<0&&(l=0);var a=t.offsetWidth-i.offsetWidth;l>a&&(l=a),i.style.left="".concat(l,"px")}(e.clientX)}function a(){document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",a)}function s(e){var t=i.getBoundingClientRect();r=e-t.left,document.addEventListener("pointermove",l),document.addEventListener("pointerup",a)}t.addEventListener("dragstart",(function(e){return e.preventDefault()})),t.addEventListener("pointerdown",(function(e){return e.target.closest(".thumb")?(s(e.clientX),!1):(i.style.left="".concat(e.clientX-n.left-i.clientWidth/2,"px"),s(e.clientX),!0)})),this.getPosition=function(){return 100*(i.offsetLeft-t.offsetLeft)/t.clientWidth}}function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var l=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"ALIVE",1),n(this,"DEAD",0),n(this,"SPEED",50),n(this,"RESIZE_MODE",0),n(this,"PLAY_MODE",1),n(this,"NEXT_MODE",2),n(this,"RAND_MODE",3),n(this,"SPEED_MODE",4),this.gameField=t.gameField,this.startBtn=t.startBtn,this.widthElem=t.widthElem,this.heightElem=t.heightElem,this.width=Number(t.widthElem.value)<Number(t.widthElem.min)?Number(t.widthElem.min):Number(t.widthElem.value),this.height=Number(t.heightElem.value)<Number(t.heightElem.min)?Number(t.heightElem.min):Number(t.heightElem.value),this.slider=t.slider,this.allCells=Array.from(Array(this.height),(function(){return new Array(i.width).fill(i.DEAD)})),this.inactiveArr=JSON.parse(JSON.stringify(this.allCells)),this.interval=null,this.aliveCellNumber=0,this.lastSpeed=this.slider.getPosition()}var t,i;return t=e,i=[{key:"generateField",value:function(e){if(e!==this.RAND_MODE){for(var t=document.createElement("tbody"),i=0;i<this.height;i+=1){for(var r=document.createElement("tr"),n=0;n<this.width;n+=1){var l=this.createCell(i,n);r.append(l)}t.append(r)}this.gameField.append(t)}else{this.aliveCellNumber=0;for(var a=0;a<this.height;a+=1)for(var s=0;s<this.width;s+=1)Math.round(Math.random())?(this.gameField.rows[a].cells[s].classList.add("alive"),this.allCells[a][s]=this.ALIVE,this.aliveCellNumber+=1):(this.gameField.rows[a].cells[s].classList.remove("alive"),this.allCells[a][s]=this.DEAD)}}},{key:"draw",value:function(e){var t=e.target;if("td"===t.tagName.toLowerCase()){var i=t.className,r=+t.dataset.row,n=+t.dataset.col;~i.indexOf("alive")?(t.classList.toggle("alive"),this.allCells[r][n]=this.allCells[r][n]?this.DEAD:this.ALIVE,this.allCells[r][n]===this.DEAD&&(this.aliveCellNumber-=1)):(t.classList.add("alive"),this.allCells[r][n]=this.ALIVE,this.aliveCellNumber+=1),console.log(this.aliveCellNumber)}}},{key:"countNeighbours",value:function(e,t){for(var i=0,r=-1;r<2;r+=1)for(var n=-1;n<2;n+=1)if(r||n){try{this.allCells[e+r][t+n]===this.ALIVE&&(i+=1)}catch(e){}if(i>3)return i}return i}},{key:"updateCellValue",value:function(e,t){var i=this.countNeighbours(e,t);return i>3||i<2?this.DEAD:this.allCells[e][t]===this.DEAD&&3===i?this.ALIVE:this.allCells[e][t]}},{key:"createCell",value:function(e,t){var i=document.createElement("td");return i.dataset.row="".concat(e),i.dataset.col="".concat(t),i.className="c c".concat(Math.floor(4*Math.random()+1)),i}},{key:"renderField",value:function(e,t){var i=this;if(!Number.isNaN(e)&&!Number.isNaN(t)){if(this.height<e){var r=Array.from(Array(e-this.height),(function(){return new Array(i.width).fill(i.DEAD)}));this.allCells=this.allCells.concat(r),this.inactiveArr=this.inactiveArr.concat(r);for(var n=this.height;n<e;n+=1){for(var l=document.createElement("tr"),a=0;a<this.width;a+=1){var s=this.createCell(n,a);l.append(s)}this.gameField.tBodies[0].append(l)}this.height=e}else if(this.height>e){for(var h=0;h<this.height-e;h+=1)this.aliveCellNumber-=this.allCells[e].filter((function(e){return e===i.ALIVE})).length,this.gameField.rows[e].remove();this.allCells.splice(e,this.height-e),this.inactiveArr.splice(e,this.height-e),this.height=e}if(this.width<t){var o=new Array(t-this.width).fill(this.DEAD);this.allCells=this.allCells.map((function(e){return e.concat(o)})),this.inactiveArr=this.inactiveArr.map((function(e){return e.concat(o)}));for(var c=0;c<this.height;c+=1)for(var u=this.width;u<t;u+=1){var d=this.createCell(c,u);this.gameField.rows[c].append(d)}this.width=t}else if(this.width>t){this.allCells.forEach((function(e){i.aliveCellNumber-=e[e.length-1],e.splice(t,i.width-t)})),this.inactiveArr.forEach((function(e){e.splice(t,i.width-t)}));for(var f=0;f<this.height;f+=1)for(var m=t;m<this.width;m+=1)this.gameField.rows[f].lastChild.remove();this.width=t}}}},{key:"setHeight",value:function(){Number(this.heightElem.value)<Number(this.heightElem.min)&&(this.heightElem.value=this.heightElem.min),this.renderField(Number(this.heightElem.value),this.width)}},{key:"setWidth",value:function(){Number(this.widthElem.value)<Number(this.widthElem.min)&&(this.widthElem.value=this.widthElem.min),this.renderField(this.height,Number(this.widthElem.value))}},{key:"updateGameField",value:function(e){var t=this;if(e!==this.NEXT_MODE&&this.slider.getPosition()!==this.lastSpeed)return this.lastSpeed=this.slider.getPosition(),clearInterval(this.interval),void this.lifeCycle(this.SPEED_MODE,100-this.lastSpeed);for(var i=0;i<this.height;i+=1)for(var r=function(r){var n=t.allCells[i][r]===t.ALIVE?t.ALIVE:t.DEAD;t.inactiveArr[i][r]=t.updateCellValue(i,r);var l=t.gameField.rows[i].cells[r];if(t.inactiveArr[i][r]!==n){var a="";t.inactiveArr[i][r]===t.ALIVE?(e===t.NEXT_MODE&&(a="new-alive"),t.aliveCellNumber+=1):(e===t.NEXT_MODE&&(a="new-dead"),t.aliveCellNumber-=1),e===t.NEXT_MODE&&(l.classList.add(a),setTimeout((function(){return l.classList.remove(a)}),1e3)),l.classList.toggle("alive")}},n=0;n<this.width;n+=1)r(n);this.allCells=JSON.parse(JSON.stringify(this.inactiveArr)),this.aliveCellNumber||(clearInterval(this.interval),this.startBtn.innerHTML="start")}},{key:"lifeCycle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.PLAY_MODE;if(arguments.length>1&&void 0!==arguments[1]||this.SPEED,!this.aliveCellNumber)return clearInterval(this.interval),void(this.startBtn.innerHTML="start");if(e!==this.RESIZE_MODE||"start"!==this.startBtn.innerHTML){if("stop"===this.startBtn.innerHTML&&e===this.PLAY_MODE)return clearInterval(this.interval),void(this.startBtn.innerHTML="start");if(this.startBtn.innerHTML="stop",e===this.NEXT_MODE)return this.startBtn.innerHTML="start",clearInterval(this.interval),void this.updateGameField.call(this,this.NEXT_MODE);this.interval=setInterval(this.updateGameField.bind(this),10*(100-this.lastSpeed))}}}],i&&r(t.prototype,i),e}(),a=document.getElementById("gamefield"),s=document.getElementById("start"),h=document.getElementById("random"),o=document.getElementById("next"),c=document.getElementById("width"),u=document.getElementById("height"),d=new(p("Slider"))({elem:document.getElementById("slider-wrapper")}),f=new(p("GameOfLife"))({widthElem:p("widthElem"),heightElem:p("heightElem"),startBtn:p("startBtn"),gameField:p("gameField"),slider:p("slider")});function m(){try{if(e.g)return e.g}catch(e){try{if(window)return window}catch(e){return this}}}p("gol").generateField(),p("gameField").addEventListener("click",p("gol").draw.bind(p("gol"))),p("widthElem").addEventListener("input",p("gol").setWidth.bind(p("gol"))),p("heightElem").addEventListener("click",p("gol").setHeight.bind(p("gol"))),p("startBtn").addEventListener("click",p("gol").lifeCycle.bind(p("gol"),p("gol").PLAY_MODE)),p("randomBtn").addEventListener("click",p("gol").generateField.bind(p("gol"),p("gol").RAND_MODE)),p("nextBtn").addEventListener("click",p("gol").lifeCycle.bind(p("gol"),p("gol").NEXT_MODE));var v,E=null;function g(){if(null===E){var e=m();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),E=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return E}function _(){var e=m();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function b(){var e=g(),t=_(),i=t[e];return i||(t[e]=Object.create(null),i=t[e]),i}(v=m()).__rewire_reset_all__||(v.__rewire_reset_all__=function(){v.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)});var w="__INTENTIONAL_UNDEFINED__",y={};function p(e){var t=b();if(void 0===t[e])return function(e){switch(e){case"Slider":return i;case"GameOfLife":return l;case"widthElem":return c;case"heightElem":return u;case"startBtn":return s;case"gameField":return a;case"slider":return d;case"gol":return f;case"randomBtn":return h;case"nextBtn":return o}}(e);var r=t[e];return r===w?void 0:r}function L(e,i){var r=b();return"object"===t(e)?(Object.keys(e).forEach((function(t){r[t]=e[t]})),function(){Object.keys(e).forEach((function(t){N(e)}))}):(r[e]=void 0===i?w:i,function(){N(e)})}function N(e){var t=b();delete t[e],0==Object.keys(t).length&&delete _()[g]}function D(e){var t=b(),i=Object.keys(e),r={};function n(){i.forEach((function(e){t[e]=r[e]}))}return function(l){i.forEach((function(i){r[i]=t[i],t[i]=e[i]}));var a=l();return a&&"function"==typeof a.then?a.then(n).catch(n):n(),a}}!function(){function e(e,t){Object.defineProperty(y,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",p),e("__GetDependency__",p),e("__Rewire__",L),e("__set__",L),e("__reset__",N),e("__ResetDependency__",N),e("__with__",D)}()}();